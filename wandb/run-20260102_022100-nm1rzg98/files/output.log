Checkpoints will be saved to: /Users/shawnspitzel/cs336/cs326/assignment1-basics/cs336_basics/checkpoints/model/gpt4-small-tinystories
Training:   0%| | 31/100000 [04:24<126:46:37,  4.57s/ iters, tr
ENTER ITER 0
ENTER ITER 1
ENTER ITER 2
ENTER ITER 3
ENTER ITER 4
ENTER ITER 5
ENTER ITER 6
ENTER ITER 7
ENTER ITER 8
ENTER ITER 9
ENTER ITER 10
ENTER ITER 11
ENTER ITER 12
ENTER ITER 13
ENTER ITER 14
ENTER ITER 15
ENTER ITER 16
ENTER ITER 17
ENTER ITER 18
ENTER ITER 19
ENTER ITER 20
ENTER ITER 21
ENTER ITER 22
ENTER ITER 23
ENTER ITER 24
ENTER ITER 25
ENTER ITER 26
ENTER ITER 27
ENTER ITER 28
ENTER ITER 29
ENTER ITER 30
ENTER ITER 31
ENTER ITER 32
ENTER ITER 33
ENTER ITER 34
ENTER ITER 35
ENTER ITER 36
ENTER ITER 37
ENTER ITER 38
ENTER ITER 39
ENTER ITER 40
ENTER ITER 41
ENTER ITER 42
ENTER ITER 43
ENTER ITER 44
ENTER ITER 45
ENTER ITER 46
ENTER ITER 47
ENTER ITER 48
ENTER ITER 49
ENTER ITER 50
ENTER ITER 51
ENTER ITER 52
ENTER ITER 53
ENTER ITER 54
ENTER ITER 55
ENTER ITER 56
ENTER ITER 57
ENTER ITER 58
ENTER ITER 59
ENTER ITER 60
ENTER ITER 61
ENTER ITER 62
ENTER ITER 63
ENTER ITER 64
ENTER ITER 65
ENTER ITER 66
ENTER ITER 67
ENTER ITER 68
ENTER ITER 69
ENTER ITER 70
ENTER ITER 71
ENTER ITER 72
ENTER ITER 73
ENTER ITER 74
ENTER ITER 75
ENTER ITER 76
ENTER ITER 77
ENTER ITER 78
ENTER ITER 79
ENTER ITER 80
ENTER ITER 81
ENTER ITER 82
ENTER ITER 83
ENTER ITER 84
ENTER ITER 85
ENTER ITER 86
ENTER ITER 87
ENTER ITER 88
ENTER ITER 89
ENTER ITER 90
ENTER ITER 91
ENTER ITER 92
ENTER ITER 93
ENTER ITER 94
ENTER ITER 95
ENTER ITER 96
ENTER ITER 97
ENTER ITER 98
ENTER ITER 99
ENTER ITER 100
ENTER ITER 101
ENTER ITER 102
ENTER ITER 103
ENTER ITER 104
ENTER ITER 105
ENTER ITER 106
ENTER ITER 107
ENTER ITER 108
ENTER ITER 109
ENTER ITER 110
ENTER ITER 111
ENTER ITER 112
ENTER ITER 113
ENTER ITER 114
ENTER ITER 115
ENTER ITER 116
ENTER ITER 117
ENTER ITER 118
ENTER ITER 119
ENTER ITER 120
ENTER ITER 121
ENTER ITER 122
ENTER ITER 123
ENTER ITER 124
ENTER ITER 125
ENTER ITER 126
ENTER ITER 127
ENTER ITER 128
ENTER ITER 129
ENTER ITER 130
ENTER ITER 131
ENTER ITER 132
ENTER ITER 133
ENTER ITER 134
ENTER ITER 135
ENTER ITER 136
ENTER ITER 137
ENTER ITER 138
ENTER ITER 139
ENTER ITER 140
ENTER ITER 141
ENTER ITER 142
ENTER ITER 143
ENTER ITER 144
ENTER ITER 145
ENTER ITER 146
ENTER ITER 147
ENTER ITER 148
ENTER ITER 149
ENTER ITER 150
ENTER ITER 151
ENTER ITER 152
ENTER ITER 153
ENTER ITER 154
ENTER ITER 155
ENTER ITER 156
ENTER ITER 157
ENTER ITER 158
ENTER ITER 159
ENTER ITER 160
ENTER ITER 161
ENTER ITER 162
ENTER ITER 163
ENTER ITER 164
ENTER ITER 165
ENTER ITER 166
ENTER ITER 167
ENTER ITER 168
ENTER ITER 169
ENTER ITER 170
ENTER ITER 171
ENTER ITER 172
ENTER ITER 173
ENTER ITER 174
ENTER ITER 175
ENTER ITER 176
ENTER ITER 177
ENTER ITER 178
ENTER ITER 179
ENTER ITER 180
ENTER ITER 181
ENTER ITER 182
ENTER ITER 183
ENTER ITER 184
ENTER ITER 185
ENTER ITER 186
ENTER ITER 187
ENTER ITER 188
ENTER ITER 189
ENTER ITER 190
ENTER ITER 191
ENTER ITER 192
ENTER ITER 193
ENTER ITER 194
ENTER ITER 195
ENTER ITER 196
ENTER ITER 197
ENTER ITER 198
ENTER ITER 199
ENTER ITER 200
ENTER ITER 201
ENTER ITER 202
ENTER ITER 203
ENTER ITER 204
ENTER ITER 205
ENTER ITER 206
ENTER ITER 207
ENTER ITER 208
ENTER ITER 209
ENTER ITER 210
ENTER ITER 211
ENTER ITER 212
ENTER ITER 213
ENTER ITER 214
ENTER ITER 215
ENTER ITER 216
ENTER ITER 217
ENTER ITER 218
ENTER ITER 219
ENTER ITER 220
ENTER ITER 221
ENTER ITER 222
ENTER ITER 223
ENTER ITER 224
ENTER ITER 225
ENTER ITER 226
ENTER ITER 227
ENTER ITER 228
ENTER ITER 229
ENTER ITER 230
ENTER ITER 231
ENTER ITER 232
ENTER ITER 233
ENTER ITER 234
ENTER ITER 235
ENTER ITER 236
ENTER ITER 237
ENTER ITER 238
ENTER ITER 239
ENTER ITER 240
ENTER ITER 241
ENTER ITER 242
ENTER ITER 243
ENTER ITER 244
ENTER ITER 245
ENTER ITER 246
ENTER ITER 247
ENTER ITER 248
ENTER ITER 249
ENTER ITER 250
ENTER ITER 251
ENTER ITER 252
ENTER ITER 253
ENTER ITER 254
ENTER ITER 255
ENTER ITER 256
ENTER ITER 257
ENTER ITER 258
ENTER ITER 259
ENTER ITER 260
ENTER ITER 261
ENTER ITER 262
ENTER ITER 263
ENTER ITER 264
ENTER ITER 265
ENTER ITER 266
ENTER ITER 267
ENTER ITER 268
ENTER ITER 269
ENTER ITER 270
ENTER ITER 271
ENTER ITER 272
ENTER ITER 273
ENTER ITER 274
ENTER ITER 275
ENTER ITER 276
ENTER ITER 277
ENTER ITER 278
ENTER ITER 279
ENTER ITER 280
ENTER ITER 281
ENTER ITER 282
ENTER ITER 283
ENTER ITER 284
ENTER ITER 285
ENTER ITER 286
ENTER ITER 287
ENTER ITER 288
ENTER ITER 289
ENTER ITER 290
ENTER ITER 291
ENTER ITER 292
ENTER ITER 293
ENTER ITER 294
ENTER ITER 295
ENTER ITER 296
ENTER ITER 297
ENTER ITER 298
ENTER ITER 299
ENTER ITER 300
ENTER ITER 301
ENTER ITER 302
ENTER ITER 303
ENTER ITER 304
ENTER ITER 305
ENTER ITER 306
ENTER ITER 307
ENTER ITER 308
ENTER ITER 309
ENTER ITER 310
ENTER ITER 311
ENTER ITER 312
ENTER ITER 313
ENTER ITER 314
ENTER ITER 315
ENTER ITER 316
ENTER ITER 317
ENTER ITER 318
ENTER ITER 319
ENTER ITER 320
ENTER ITER 321
ENTER ITER 322
ENTER ITER 323
ENTER ITER 324
ENTER ITER 325
ENTER ITER 326
ENTER ITER 327
ENTER ITER 328
ENTER ITER 329
ENTER ITER 330
ENTER ITER 331
ENTER ITER 332
ENTER ITER 333
ENTER ITER 334
ENTER ITER 335
ENTER ITER 336
ENTER ITER 337
ENTER ITER 338
ENTER ITER 339
ENTER ITER 340
ENTER ITER 341
ENTER ITER 342
ENTER ITER 343
ENTER ITER 344
ENTER ITER 345
ENTER ITER 346
ENTER ITER 347
ENTER ITER 348
ENTER ITER 349
ENTER ITER 350
ENTER ITER 351
ENTER ITER 352
ENTER ITER 353
ENTER ITER 354
ENTER ITER 355
ENTER ITER 356
ENTER ITER 357
ENTER ITER 358
ENTER ITER 359
ENTER ITER 360
ENTER ITER 361
ENTER ITER 362
ENTER ITER 363
ENTER ITER 364
ENTER ITER 365
ENTER ITER 366
ENTER ITER 367
ENTER ITER 368
ENTER ITER 369
ENTER ITER 370
ENTER ITER 371
ENTER ITER 372
ENTER ITER 373
ENTER ITER 374
ENTER ITER 375
ENTER ITER 376
ENTER ITER 377
ENTER ITER 378
ENTER ITER 379
ENTER ITER 380
ENTER ITER 381
ENTER ITER 382
ENTER ITER 383
ENTER ITER 384
ENTER ITER 385
ENTER ITER 386
ENTER ITER 387
ENTER ITER 388
ENTER ITER 389
ENTER ITER 390
ENTER ITER 391
ENTER ITER 392
ENTER ITER 393
ENTER ITER 394
ENTER ITER 395
ENTER ITER 396
ENTER ITER 397
ENTER ITER 398
ENTER ITER 399
ENTER ITER 400
ENTER ITER 401
ENTER ITER 402
ENTER ITER 403
ENTER ITER 404
ENTER ITER 405
ENTER ITER 406
ENTER ITER 407
ENTER ITER 408
ENTER ITER 409
ENTER ITER 410
ENTER ITER 411
ENTER ITER 412
ENTER ITER 413
ENTER ITER 414
ENTER ITER 415
ENTER ITER 416
ENTER ITER 417
ENTER ITER 418
ENTER ITER 419
ENTER ITER 420
ENTER ITER 421
ENTER ITER 422
ENTER ITER 423
ENTER ITER 424
ENTER ITER 425
ENTER ITER 426
ENTER ITER 427
ENTER ITER 428
ENTER ITER 429
ENTER ITER 430
ENTER ITER 431
ENTER ITER 432
ENTER ITER 433
ENTER ITER 434
ENTER ITER 435
ENTER ITER 436
ENTER ITER 437
ENTER ITER 438
ENTER ITER 439
ENTER ITER 440
ENTER ITER 441
ENTER ITER 442
ENTER ITER 443
ENTER ITER 444
ENTER ITER 445
ENTER ITER 446
ENTER ITER 447
ENTER ITER 448
ENTER ITER 449
ENTER ITER 450
ENTER ITER 451
ENTER ITER 452
ENTER ITER 453
ENTER ITER 454
ENTER ITER 455
ENTER ITER 456
ENTER ITER 457
ENTER ITER 458
ENTER ITER 459
ENTER ITER 460
ENTER ITER 461
ENTER ITER 462
ENTER ITER 463
ENTER ITER 464
ENTER ITER 465
ENTER ITER 466
ENTER ITER 467
ENTER ITER 468
ENTER ITER 469
ENTER ITER 470
ENTER ITER 471
ENTER ITER 472
ENTER ITER 473
ENTER ITER 474
ENTER ITER 475
ENTER ITER 476
ENTER ITER 477
ENTER ITER 478
ENTER ITER 479
ENTER ITER 480
ENTER ITER 481
ENTER ITER 482
ENTER ITER 483
ENTER ITER 484
ENTER ITER 485
ENTER ITER 486
ENTER ITER 487
ENTER ITER 488
ENTER ITER 489
ENTER ITER 490
ENTER ITER 491
ENTER ITER 492
ENTER ITER 493
ENTER ITER 494
ENTER ITER 495
ENTER ITER 496
ENTER ITER 497
ENTER ITER 498
ENTER ITER 499
ENTER ITER 500
ENTER ITER 501
ENTER ITER 502
ENTER ITER 503
ENTER ITER 504
ENTER ITER 505
ENTER ITER 506
ENTER ITER 507
ENTER ITER 508
ENTER ITER 509
ENTER ITER 510
ENTER ITER 511
ENTER ITER 512
ENTER ITER 513
ENTER ITER 514
ENTER ITER 515
ENTER ITER 516
ENTER ITER 517
ENTER ITER 518
ENTER ITER 519
ENTER ITER 520
ENTER ITER 521
ENTER ITER 522
ENTER ITER 523
ENTER ITER 524
ENTER ITER 525
ENTER ITER 526
ENTER ITER 527
ENTER ITER 528
ENTER ITER 529
ENTER ITER 530
ENTER ITER 531
ENTER ITER 532
ENTER ITER 533
ENTER ITER 534
ENTER ITER 535
ENTER ITER 536
ENTER ITER 537
ENTER ITER 538
ENTER ITER 539
ENTER ITER 540
ENTER ITER 541
ENTER ITER 542
ENTER ITER 543
ENTER ITER 544
ENTER ITER 545
ENTER ITER 546
ENTER ITER 547
ENTER ITER 548
ENTER ITER 549
ENTER ITER 550
ENTER ITER 551
ENTER ITER 552
ENTER ITER 553
ENTER ITER 554
ENTER ITER 555
ENTER ITER 556
ENTER ITER 557
ENTER ITER 558
ENTER ITER 559
ENTER ITER 560
ENTER ITER 561
ENTER ITER 562
ENTER ITER 563
ENTER ITER 564
ENTER ITER 565
ENTER ITER 566
ENTER ITER 567
ENTER ITER 568
ENTER ITER 569
ENTER ITER 570
ENTER ITER 571
ENTER ITER 572
ENTER ITER 573
ENTER ITER 574
ENTER ITER 575
ENTER ITER 576
ENTER ITER 577
ENTER ITER 578
ENTER ITER 579
ENTER ITER 580
ENTER ITER 581
ENTER ITER 582
ENTER ITER 583
ENTER ITER 584
ENTER ITER 585
ENTER ITER 586
ENTER ITER 587
ENTER ITER 588
ENTER ITER 589
ENTER ITER 590
ENTER ITER 591
ENTER ITER 592
ENTER ITER 593
ENTER ITER 594
ENTER ITER 595
ENTER ITER 596
ENTER ITER 597
ENTER ITER 598
ENTER ITER 599
ENTER ITER 600
ENTER ITER 601
ENTER ITER 602
ENTER ITER 603
ENTER ITER 604
ENTER ITER 605
ENTER ITER 606
ENTER ITER 607
ENTER ITER 608
ENTER ITER 609
ENTER ITER 610
ENTER ITER 611
ENTER ITER 612
ENTER ITER 613
ENTER ITER 614
ENTER ITER 615
ENTER ITER 616
ENTER ITER 617
ENTER ITER 618
ENTER ITER 619
ENTER ITER 620
ENTER ITER 621
ENTER ITER 622
ENTER ITER 623
ENTER ITER 624
ENTER ITER 625
ENTER ITER 626
ENTER ITER 627
ENTER ITER 628
ENTER ITER 629
ENTER ITER 630
ENTER ITER 631
ENTER ITER 632
ENTER ITER 633
ENTER ITER 634
ENTER ITER 635
ENTER ITER 636
ENTER ITER 637
ENTER ITER 638
ENTER ITER 639
ENTER ITER 640
ENTER ITER 641
ENTER ITER 642
ENTER ITER 643
ENTER ITER 644
ENTER ITER 645
ENTER ITER 646
ENTER ITER 647
ENTER ITER 648
ENTER ITER 649
ENTER ITER 650
ENTER ITER 651
ENTER ITER 652
ENTER ITER 653
ENTER ITER 654
ENTER ITER 655
ENTER ITER 656
ENTER ITER 657
ENTER ITER 658
ENTER ITER 659
ENTER ITER 660
ENTER ITER 661
ENTER ITER 662
ENTER ITER 663
ENTER ITER 664
ENTER ITER 665
ENTER ITER 666
ENTER ITER 667
ENTER ITER 668
ENTER ITER 669
ENTER ITER 670
ENTER ITER 671
ENTER ITER 672
ENTER ITER 673
ENTER ITER 674
ENTER ITER 675
ENTER ITER 676
ENTER ITER 677
ENTER ITER 678
ENTER ITER 679
ENTER ITER 680
ENTER ITER 681
ENTER ITER 682
ENTER ITER 683
ENTER ITER 684
ENTER ITER 685
ENTER ITER 686
ENTER ITER 687
ENTER ITER 688
ENTER ITER 689
ENTER ITER 690
ENTER ITER 691
ENTER ITER 692
ENTER ITER 693
ENTER ITER 694
ENTER ITER 695
ENTER ITER 696
ENTER ITER 697
ENTER ITER 698
ENTER ITER 699
ENTER ITER 700
ENTER ITER 701
ENTER ITER 702
ENTER ITER 703
ENTER ITER 704
ENTER ITER 705
ENTER ITER 706
ENTER ITER 707
ENTER ITER 708
ENTER ITER 709
ENTER ITER 710
ENTER ITER 711
ENTER ITER 712
ENTER ITER 713
ENTER ITER 714
ENTER ITER 715
ENTER ITER 716
ENTER ITER 717
ENTER ITER 718
ENTER ITER 719
ENTER ITER 720
ENTER ITER 721
ENTER ITER 722
ENTER ITER 723
ENTER ITER 724
ENTER ITER 725
ENTER ITER 726
ENTER ITER 727
ENTER ITER 728
ENTER ITER 729
ENTER ITER 730
ENTER ITER 731
Traceback (most recent call last):
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/cs336_basics/training/pretrain.py", line 233, in <module>
    run(params)
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/cs336_basics/training/pretrain.py", line 142, in run
    model=model,

  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/cs336_basics/training/pretrain.py", line 41, in pretrain
    logits = model(inputs)
             ^^^^^^^^^^^^^
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/cs336_basics/model/transformer.py", line 57, in forward
    x = self.lm_head(x)
        ^^^^^^^^^^^^^^^
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/shawnspitzel/cs336/cs326/assignment1-basics/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
